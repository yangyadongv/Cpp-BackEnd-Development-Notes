# 数据库-后盾人

- select * from stu;
  - *：查询stu表的所有表项（行）的所有列
- select  class_id from stu;
  - class_id ：只查询stu表的所有表项（行）的class_id列

## 1.简单命令-数据库

- 创建数据库

  - ```
    mysql> create database shop charset utf8;
    //charset utf8是选定编码方式
    ```

- 查看创建的数据库

  - ```
    mysql> show databases;
    +--------------------+
    | Database           |
    +--------------------+
    | information_schema |
    | mysql              |
    | performance_schema |
    | shop               |  //这是刚才创建的shop数据库
    | sys                |
    | yourdb             |
    +--------------------+
    6 rows in set (0.00 sec)
    
    mysql>
    ```

- 使用某个数据库

  - ```
    mysql> use shop;
    Database changed
    mysql>
    ```

- 删除某个数据库

  - ```
    mysql> drop database shop;
    Query OK, 0 rows affected (0.01 sec)
    mysql>
    ```

  - 或者加个判断

    - ```
      mysql> drop database if exists shop;
      ```

- 查看创建的数据库的结构

  - ```
    mysql> show create database shop;
    +----------+---------------------------------------------------------------+
    | Database | Create Database                                               |
    +----------+---------------------------------------------------------------+
    | shop     | CREATE DATABASE `shop` /*!40100 DEFAULT CHARACTER SET utf8 */ |
    +----------+---------------------------------------------------------------+
    1 row in set (0.00 sec)
    
    mysql>
    ```

## 2.简单命令-表

- 创建一个表

  - ```
    CREATE TABLE class(id int primary key auto_increment,cname varchar(30) not null,description varchar(100) null) charset utf8;
    ```

  - 字段 id ：为主键自增

    - primary key是主键，让我们的id值有个索引。这样的话我们查找id=1，id=2的时候速度会比较快。
    - auto_increment是自增，主键不用我们手动维护，它会自动增加。

  - 字段 cname 为字符串类型varchar 并不允许为 null

  - 字段 description 为可为null 字符串

  - 字符集为 utf8 ，如果不设置将继承数据库字符集

- 查看表

  - ```
    mysql> desc class;
    +-------------+--------------+------+-----+---------+----------------+
    | Field       | Type         | Null | Key | Default | Extra          |
    +-------------+--------------+------+-----+---------+----------------+
    | id          | int(11)      | NO   | PRI | NULL    | auto_increment |
    | cname       | varchar(30)  | NO   |     | NULL    |                |
    | description | varchar(100) | YES  |     | NULL    |                |
    +-------------+--------------+------+-----+---------+----------------+
    3 rows in set (0.00 sec)
    
    mysql>
    ```

- 向表里添加测试数据

  - 方法1

    - ```
      INSERT into class set cname ='PHP',description ='学习 PHP 开发网站';
      ```

  - 方法2

    - ```
      INSERT into class (cname,description) values('linux','服务器知识'),('mysql','数据库学习'),('C++',null);
      ```

- 查看表数据

  - ```
    select * from class;
    ```

  - ![image-20210228150153425](http://pichost.yangyadong.site/img/image-20210228150153425.png)

## 3.已经有一个表了，从一个表快速构建另一个表

- ```
  CREATE table test like class;//根据已经存在的表结构创建新表
  insert into test select * from class;//复制class表的所有数据到test表中
  insert into test (cname) select cname from class;//只复制批定字段
  
  CREATE table a select * from class;//创建表时同时复制数据
  
  CREATE table b (id int primary key auto_increment,cname varchar(30)) select cname FROM class;//只复制指定字段
  
  CREATE table c (id int primary key auto_increment,name varchar(30)) select cname as name FROM class;//只复制指定字段，并起别名
  ```

## 4.查询基本操作

- 从class表中，查询所有字段

  - ```
    SELECT * from class;
    ```

  - ![image-20210228153331459](http://pichost.yangyadong.site/img/image-20210228153331459.png)

- 从class表中，查询特定字段

  - ```
    SELECT cname,id FROM class;
    ```

  - ![image-20210228153519806](http://pichost.yangyadong.site/img/image-20210228153519806.png)

- 从class表中，查询特定字段，并为该字段起别名

  - ```
    SELECT cname,id as iddd FROM class;
    ```

  - ![image-20210228153721734](http://pichost.yangyadong.site/img/image-20210228153721734.png)

- 根据条件的查询

  - ```
    SELECT * FROM class where id>2;//筛选出id>2的
    ```

    - ![image-20210228154018543](http://pichost.yangyadong.site/img/image-20210228154018543.png)

  - ```
    SELECT * FROM class where cname='PHP';//筛选出cname是php的
    ```

    - ![image-20210228154136590](http://pichost.yangyadong.site/img/image-20210228154136590.png)

  - ```
    SELECT * from class where description like '%学习%'; //查找出description字段中包含学习字段的数据
    ```

    - ![image-20210228154456223](http://pichost.yangyadong.site/img/image-20210228154456223.png)

  - ```
    SELECT * from class where description like '%学习%' and id>2; //查找出description字段中包含学习字段的，并且id>2的数据
    ```

    - ![image-20210228154543087](http://pichost.yangyadong.site/img/image-20210228154543087.png)

  - ```
    SELECT * from class where description not like '%学习%' and id>2;////查找出description字段中不包含学习字段的，并且id>2的数据
    ```

    - ![image-20210228154713550](http://pichost.yangyadong.site/img/image-20210228154713550.png)

- 使用连接函数的查询

  - ```
    SELECT CONCAT(cname,description) as class_info FROM class;
    ```

  - ![image-20210228154939326](http://pichost.yangyadong.site/img/image-20210228154939326.png)

## 5.查询进阶（DISTINCT、BETWEEN、like等）

- 关键字
  - distinct：去掉重复的
  - BETWEEN a and b：a到b之间
  - in (2,3)：2到3之间[2,3]
  - and、or
  - like：包含..

- 已知stu表

  - ![image-20210228164748558](http://pichost.yangyadong.site/img/image-20210228164748558.png)

- 查询所有的class_id

  - ```
    SELECT class_id from stu;
    ```

  - ![image-20210228164948740](http://pichost.yangyadong.site/img/image-20210228164948740.png)

  - 有重复项

- 查询所有的class_id，**去掉重复项**

  - ```
    SELECT DISTINCT class_id FROM stu;
    ```

  - ![image-20210228165046380](http://pichost.yangyadong.site/img/image-20210228165046380.png)

- 查询20~40岁之间的同学

  - ```
    SELECT * FROM stu where age >=20 and age <=40;
    ```

  - 或者是

  - ```
    SELECT * FROM stu where age BETWEEN 20 and 40;
    ```

- 查询不在20~40岁之间的同学

  - ```
    SELECT * FROM stu where age not BETWEEN 20 and 40;
    ```

- 查询在2班到3班的同学

  - ```
    SELECT * FROM stu where class_id =2 or class_id =3;
    ```

  - 或者是

  - ```
    SELECT * FROM stu where class_id in (2,3);
    ```

## 6.mysql对null值的处理技巧

- 已知stu表

  - ![image-20210228164748558](http://pichost.yangyadong.site/img/image-20210228164748558.png)

- 比如你想查询class_id为null的那些数据

  - ```
    mysql> select * from stu where class_id=null;
    Empty set (0.00 sec)
    
    mysql>
    ```

  - 查询失败。

- 正确写法

  - ```
    select * from stu where class_id is null;
    ```

  - ![image-20210228171339872](http://pichost.yangyadong.site/img/image-20210228171339872.png)

- ifnull函数

  - 如果class_id有值的话，就让它显示那个值。如果没值，就让它显示未分配。

  - ```
    SELECT sname ,if(class_id,class_id,'未分配') FROM stu;
    或者
    SELECT sname,IFNULL(class_id,'未分配') FROM stu;
    ```

  - ![image-20210228171740665](http://pichost.yangyadong.site/img/image-20210228171740665.png)

## 7.排序与数据区间筛选处理技巧

- order by age desc；按照年龄从大到小排序（desc降序）

  - ![image-20210228172014660](http://pichost.yangyadong.site/img/image-20210228172014660.png)

- order by class_id asc；按照班级从小到大排序(asc升序)

  - ![image-20210228172246439](http://pichost.yangyadong.site/img/image-20210228172246439.png)

- 按照班级从小到大排序，同班同学按年龄从小到大升序

  - ![image-20210228172408652](http://pichost.yangyadong.site/img/image-20210228172408652.png)

- 取数据库里最后一个填进去的同学的记录（使用limit关键字）

  - ```
    mysql> select * from stu order by id desc limit 1;
    按照id降序排列，只取1个数据
    ```

  - ![image-20210228172619909](http://pichost.yangyadong.site/img/image-20210228172619909.png)

- limit 0,2和limit 1,2

  - ![image-20210228172919236](http://pichost.yangyadong.site/img/image-20210228172919236.png)

# 简洁

- SQL语句
- 对于单条记录的操作
  - 查询：SELECT
  - 操纵：INSERT、UPDATA、DELETE
- 对于表的操作
  - CREATE、DROP、ALTER













